{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2024-04-08T19:07:24.091909Z", "invocation_id": "a08127f1-7266-4b84-94d8-03845a11ac19", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:04.596202Z", "completed_at": "2024-04-08T19:07:04.610203Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:04.613206Z", "completed_at": "2024-04-08T19:07:05.886634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3761060237884521, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf8ed"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.stg_events", "compiled": true, "compiled_code": "\n \n\nWITH\n\ndatatype_conversion AS (\n \n    SELECT\n\n        *\n    \n    FROM FinalProject.public.events\n \n),\n\ncasted_datatypes AS (\n    SELECT\n        CAST(_ID AS VARCHAR) AS marks_id,\n        TO_DATE(DATE, 'MM/DD/YYYY') AS date_value,\n        TO_TIME(TIME) AS time_value,\n        CAST(DETAILS AS VARCHAR) AS details\n    FROM\n        datatype_conversion \n)\n\nSELECT * FROM casted_datatypes", "relation_name": "FinalProject.Public_staging.stg_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:05.978429Z", "completed_at": "2024-04-08T19:07:05.985396Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:05.987389Z", "completed_at": "2024-04-08T19:07:07.154951Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.263301134109497, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf8f1"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.stg_marks", "compiled": true, "compiled_code": "\n \n\nWITH\n\ndatatype_conversion AS (\n \n    SELECT\n\n        *\n    \n    FROM FinalProject.public.marks\n \n),\n\ncasted_datatypes AS (\n    \n    SELECT\n        CAST(_ID AS VARCHAR) AS marks_id,\n        CAST(MODULEID AS VARCHAR) AS moduleid,\n        CAST(USERID AS VARCHAR) AS userid,\n        CAST(MARKS AS INT) AS marks_value  \n    \n    FROM datatype_conversion\n\n)\n \nSELECT * FROM casted_datatypes", "relation_name": "FinalProject.Public_staging.stg_marks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:07.246695Z", "completed_at": "2024-04-08T19:07:07.252217Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:07.255219Z", "completed_at": "2024-04-08T19:07:08.548711Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3874576091766357, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf8f5"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.stg_modules", "compiled": true, "compiled_code": "\n \n\nWITH\n\ndatatype_conversion AS (\n \n    SELECT\n\n        *\n    \n    FROM FinalProject.public.modules\n \n),\n\n\ncasted_datatypes AS (\n    SELECT\n        CAST(_ID AS VARCHAR) AS module_id,\n        CAST(MODULENAME AS VARCHAR) AS module_name,\n        TO_DATE(STARTDATE, 'MM/DD/YYYY') AS start_date,\n        TO_DATE(ENDDATE, 'MM/DD/YYYY') AS end_date,\n        CAST(MODULESTATUS AS VARCHAR) AS module_status,\n        CAST(QUIZID AS VARCHAR) AS quiz_id,\n        CAST(TRAINER AS VARCHAR) AS trainer\n    FROM\n        datatype_conversion\n)\n\n\n\nSELECT * from casted_datatypes", "relation_name": "FinalProject.Public_staging.stg_modules"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:08.644157Z", "completed_at": "2024-04-08T19:07:08.649174Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:08.650160Z", "completed_at": "2024-04-08T19:07:10.088964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5319507122039795, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f85-0000-000419aaeed5"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.stg_quizzes", "compiled": true, "compiled_code": "\n \n\nWITH\n\ndatatype_conversion AS (\n \n    SELECT\n\n        *\n    \n    FROM FinalProject.public.quizzes\n \n),\n\ncasted_datatypes AS (\n    SELECT\n        CAST(_ID AS VARCHAR) AS topic_id,\n        CAST(TOPIC AS VARCHAR) AS topic_name,\n        QUESTIONS AS questions\n    FROM\n        datatype_conversion\n)\n\n\nSELECT * from casted_datatypes", "relation_name": "FinalProject.Public_staging.stg_quizzes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:10.185108Z", "completed_at": "2024-04-08T19:07:10.196115Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:10.199108Z", "completed_at": "2024-04-08T19:07:11.641061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5464684963226318, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f85-0000-000419aaeed9"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.stg_registers", "compiled": true, "compiled_code": "\n \n\nWITH\n\ndatatype_conversion AS (\n \n    SELECT\n\n        *\n    \n    FROM FinalProject.public.registers\n \n),\n\n\ncasted_datatypes AS (\n    SELECT\n        CAST(_ID AS VARCHAR) AS user_id,\n        CAST(NAME AS VARCHAR) AS name,\n        CAST(EMAIL AS VARCHAR) AS email,\n        CAST(PASSWORD AS VARCHAR) AS password,\n        CAST(ROLE AS VARCHAR) AS role,\n        CASE CHECKRESET WHEN 'true' THEN TRUE ELSE FALSE END AS check_reset,\n        CAST(MODULES AS VARCHAR) AS modules\n    FROM\n        datatype_conversion\n)\n\n\nSELECT * from casted_datatypes", "relation_name": "FinalProject.Public_staging.stg_registers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:11.735584Z", "completed_at": "2024-04-08T19:07:11.740574Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:11.741578Z", "completed_at": "2024-04-08T19:07:13.097926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4513707160949707, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf8f9"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.Avg_module_marks", "compiled": true, "compiled_code": "\n\n\nWITH module_avg_marks AS (\n    SELECT\n        m.module_id,\n        m.module_name,\n        AVG(ma.marks_value) AS avg_marks\n    FROM\n        FinalProject.Public_staging.stg_modules m\n    JOIN\n        FinalProject.Public_staging.stg_marks ma ON m.module_id = ma.moduleid\n    GROUP BY\n        m.module_id,\n        m.module_name\n)\n\n\nSELECT\n    module_id,\n    module_name,\n    avg_marks\nFROM\n    module_avg_marks", "relation_name": "FinalProject.Public_mart.Avg_module_marks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:13.192943Z", "completed_at": "2024-04-08T19:07:13.197904Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:13.198905Z", "completed_at": "2024-04-08T19:07:14.637552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5311274528503418, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f85-0000-000419aaeedd"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.TrainerPerModule", "compiled": true, "compiled_code": "\n\nWITH stg_modules AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_modules\n),\n\nmodule_trainer_count AS (\n    SELECT\n        module_id,\n        module_name,\n        COUNT(DISTINCT trainer) AS trainer_count\n    FROM\n        stg_modules\n    GROUP BY\n        module_id,\n        module_name\n),\n\nfinal_output AS (\n    SELECT\n        module_id,\n        module_name,\n        trainer_count\n    FROM\n        module_trainer_count\n    ORDER BY\n        trainer_count DESC\n)\n\nSELECT\n    *\nFROM\n    final_output", "relation_name": "FinalProject.Public_mart.TrainerPerModule"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:14.729026Z", "completed_at": "2024-04-08T19:07:14.734026Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:14.736027Z", "completed_at": "2024-04-08T19:07:15.858387Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2147514820098877, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf8fd"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.module_status", "compiled": true, "compiled_code": "\n\n\n-- model: stg_modules\n-- description: Reference the stg_modules table from the specified source\nWITH stg_modules AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_modules\n)\n\n-- model: count_module_status\n-- description: Counts modules by their status\nSELECT\n    module_status,\n    COUNT(distinct module_id) AS status_count\nFROM\n    stg_modules\nGROUP BY\n    module_status", "relation_name": "FinalProject.Public_mart.module_status"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:15.950801Z", "completed_at": "2024-04-08T19:07:15.957798Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:15.959803Z", "completed_at": "2024-04-08T19:07:17.416004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5643048286437988, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf901"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.count_top_user", "compiled": true, "compiled_code": "\n\n\n-- model: stg_registers\n-- description: Reference the stg_registers table from the specified source\nWITH stg_registers AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_registers\n),\n\n-- model: stg_modules\n-- description: Reference the stg_modules table from the specified source\nstg_modules AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_modules\n),\n\n-- model: stg_marks\n-- description: Reference the stg_marks table from the specified source\nstg_marks AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_marks\n),\n\n-- model: module_user_marks\n-- description: Calculates the count of distinct users per module with marks > 80\nmodule_user_marks AS (\n    SELECT\n        r.name AS user_name,\n        m.module_name,\n        ma.marks_value AS marks\n    FROM\n        stg_registers r\n    JOIN\n        stg_modules m ON r.modules = m.module_id\n    JOIN\n        stg_marks ma ON r.user_id = ma.userid AND m.module_id = ma.moduleid\n    WHERE\n        ma.marks_value > 80\n)\n\n-- model: module_users_count\n-- description: Calculates the count of distinct users per module with marks > 80\nSELECT\n    module_name,\n    COUNT(DISTINCT user_name) AS users_count\nFROM\n    module_user_marks\nGROUP BY\n    module_name\n\nORDER BY users_count DESC", "relation_name": "FinalProject.Public_mart.count_top_user"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:17.520094Z", "completed_at": "2024-04-08T19:07:17.525093Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:17.527094Z", "completed_at": "2024-04-08T19:07:18.845266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.405855417251587, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f85-0000-000419aaeee1"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.count_weak_performer", "compiled": true, "compiled_code": "\n\n\n-- model: stg_registers\n-- description: Reference the stg_registers table from the specified source\nWITH stg_registers AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_registers\n),\n\n-- model: stg_modules\n-- description: Reference the stg_modules table from the specified source\nstg_modules AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_modules\n),\n\n-- model: stg_marks\n-- description: Reference the stg_marks table from the specified source\nstg_marks AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_marks\n),\n\n-- model: module_user_marks_low_marks\n-- description: Retrieves user names, module names, and marks for users with marks < 50\nmodule_user_marks_low_marks AS (\n    SELECT\n        r.name AS user_name,\n        m.module_name,\n        ma.marks_value AS marks\n    FROM\n        stg_registers r\n    JOIN\n        stg_modules m ON r.modules = m.module_id\n    JOIN\n        stg_marks ma ON r.user_id = ma.userid AND m.module_id = ma.moduleid\n    WHERE\n        ma.marks_value < 50\n)\n\n-- model: module_users_count_low_marks\n-- description: Calculates the count of distinct users per module with marks < 50\nSELECT\n    module_name,\n    COUNT(DISTINCT user_name) AS users_count\nFROM\n    module_user_marks_low_marks\nGROUP BY\n    module_name\n\nORDER BY users_count DESC", "relation_name": "FinalProject.Public_mart.count_weak_performer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:18.930910Z", "completed_at": "2024-04-08T19:07:18.936912Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:18.937912Z", "completed_at": "2024-04-08T19:07:20.098667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2527554035186768, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f85-0000-000419aaeee9"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.employee_module_count", "compiled": true, "compiled_code": "\n\n-- model: stg_registers\n-- description: Reference the stg_registers table from the specified source\nWITH stg_registers AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_registers\n),\n\n-- model: users_by_module_count\n-- description: Calculates count of users by number of modules they are enrolled in\nusers_by_module_count AS (\n    SELECT\n        name,\n        COUNT(modules) AS num_modules\n    FROM\n        stg_registers\n    GROUP BY\n        name\n)\n\n-- model: count_users_by_module_count\n-- description: Counts users by the number of modules they are enrolled in\nSELECT\n    num_modules,\n    COUNT(*) AS count_users\nFROM\n    users_by_module_count\nGROUP BY\n    num_modules\nORDER BY\n    num_modules", "relation_name": "FinalProject.Public_mart.employee_module_count"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:20.190697Z", "completed_at": "2024-04-08T19:07:20.196721Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:20.198696Z", "completed_at": "2024-04-08T19:07:21.357614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2942357063293457, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf905"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.overall_performer", "compiled": true, "compiled_code": "\n\n-- model: stg_registers\n-- description: Reference the stg_registers table from the specified source\nWITH stg_registers AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_registers\n),\n\n-- model: stg_marks\n-- description: Reference the stg_marks table from the specified source\nstg_marks AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_marks\n),\n\n-- model: user_total_marks\n-- description: Calculates total marks and number of modules for top 5 users with highest total marks\nuser_total_marks AS (\n    SELECT\n        r.name AS user_name,\n        SUM(ma.marks_value) AS total_marks,\n        COUNT(ma.moduleid) AS num_modules\n    FROM\n        stg_registers r\n    JOIN\n        stg_marks ma ON r.user_id = ma.userid\n    WHERE\n        ma.marks_value > 0  -- Consider all marks (remove if specific filter is needed)\n    GROUP BY\n        r.name\n    ORDER BY\n        total_marks DESC\n    LIMIT 5  -- Limit to top 5 users with highest total marks\n)\n\n-- model: top_users_average_marks\n-- description: Calculates average marks per module for top users with highest total marks\nSELECT\n    user_name,\n    ROUND(total_marks / num_modules, 2) AS average_marks\nFROM\n    user_total_marks\nORDER BY\n    average_marks DESC", "relation_name": "FinalProject.Public_mart.overall_performer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:21.491053Z", "completed_at": "2024-04-08T19:07:21.496049Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:21.499041Z", "completed_at": "2024-04-08T19:07:22.699833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3081398010253906, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf909"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.top_user", "compiled": true, "compiled_code": "\n\n\nWITH stg_registers AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_registers\n),\n\nstg_marks AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_marks\n),\n\nstg_modules AS (\n    SELECT\n        *\n    FROM FinalProject.Public_staging.stg_modules\n),\n\nmodule_user_marks AS (\n    SELECT DISTINCT\n        r.name AS user_name,\n        m.module_name,\n        ma.marks_value AS marks\n    FROM\n        stg_registers r\n    JOIN\n        stg_modules m ON r.modules = m.module_id\n    JOIN\n        stg_marks ma ON r.user_id = ma.userid AND m.module_id = ma.moduleid\n    WHERE\n        ma.marks_value > 80\n)\n\nSELECT\n    user_name,\n    module_name,\n    marks\nFROM\n    module_user_marks\nORDER BY marks DESC", "relation_name": "FinalProject.Public_mart.top_user"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-08T19:07:22.818096Z", "completed_at": "2024-04-08T19:07:22.823127Z"}, {"name": "execute", "started_at": "2024-04-08T19:07:22.825100Z", "completed_at": "2024-04-08T19:07:23.990487Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2687900066375732, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3899b-0001-1f84-0000-000419aaf90d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Final_Project.top_users_module", "compiled": true, "compiled_code": "\n\nwith ranked_users as (\n  select\n   distinct r.name as user_name,\n    m.module_name,\n    ma.marks_value,\n    dense_rank() over (partition by m.module_id order by ma.marks_value desc) as user_rank\n  from\n    FinalProject.Public_staging.stg_registers r\n  join\n    FinalProject.Public_staging.stg_modules m\n    on r.modules = m.module_id\n  join\n    FinalProject.Public_staging.stg_marks ma\n    on r.user_id = ma.userid\n    and m.module_id = ma.moduleid\n)\n\nselect\n  user_name,\n  module_name,\n  marks_value\nfrom\n  ranked_users\nwhere\n  user_rank <= 5", "relation_name": "FinalProject.Public_mart.top_users_module"}], "elapsed_time": 23.25782823562622, "args": {"enable_legacy_logger": false, "log_format_file": "debug", "version_check": true, "introspect": true, "printer_width": 80, "select": [], "partial_parse": true, "invocation_command": "dbt run", "which": "run", "log_path": "C:\\FinalProject\\DBT\\Final_Project\\logs", "log_file_max_bytes": 10485760, "exclude": [], "defer": false, "vars": {}, "static_parser": true, "favor_state": false, "log_level": "info", "print": true, "use_colors_file": true, "write_json": true, "show_resource_report": false, "log_format": "default", "populate_cache": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "profiles_dir": "C:\\Users\\Asus\\.dbt", "log_level_file": "debug", "indirect_selection": "eager", "partial_parse_file_diff": true, "quiet": false, "strict_mode": false, "project_dir": "C:\\FinalProject\\DBT\\Final_Project"}}